<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <link rel="stylesheet" href="src/cadastro.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tela Cadastro</title>
  </head>
  <body>

    <div class="btn-voltar">
      <a class="voltar" type="submit" href="index.html">Voltar</a>
    </div>

    <div class="CadastroContainer">
      <h1>Cadastro</h1>

      <div class="Dados">
        <div class="linha">
          <div class="campo">
            <label for="name">Nome</label>
            <input type="text" id="nome" placeholder="Seu nome completo" />
          </div>

          <div class="campo">
            <label for="cpf">CPF</label>
            <input
              type="text"
              id="cpf"
              placeholder="000.000.000-00"
              maxlength="14"
            />
          </div>
        </div>

        <div class="linha">
          <div class="campo">
            <label for="email">E-mail</label>
            <input
              type="text"
              id="email"
              placeholder="Seu E-mail"
              maxlength="100"
            />
            <p id="erro-email" style="color: red; font-size: 14px; margin-top: 4px; margin-top: 4px; background-color: transparent; margin-bottom: -18px;"></p>
          </div>

          <div class="campo">
            <label for="date">Data de nascimento</label>
            <input type="date" id="nascimento" />
          </div>
        </div>

        <div class="linha">
          <div class="campo">
            <label for="senha">Senha</label>
            <input
              type="password"
              id="senha"
              placeholder="Sua senha"
            />
          </div>

          <div class="campo">
            <label for="confirma">Confirme sua senha</label>
            <input
              type="password"
              id="confirma"
              placeholder="Confirme sua senha"
            />
            <p id="erro-senha" style="color: red; font-size: 14px; margin-top: 4px; background-color: transparent; margin-bottom: -23px;"></p>
          </div>
        </div>

        <div class="btn-entrar">
          <button class="entrar" type="submit">Cadastrar</button>
        </div>
      </div>
    </div>

    <script>
      // Máscara de CPF
      document.addEventListener('DOMContentLoaded', () => {
        const inputCpf = document.getElementById('cpf');
        inputCpf.addEventListener('input', () => {
          let valor = inputCpf.value.replace(/\D/g, '').slice(0, 11);

          if (valor.length > 9) {
            valor = valor.replace(/(\d{3})(\d{3})(\d{3})(\d{1,2})/, '$1.$2.$3-$4');
          } else if (valor.length > 6) {
            valor = valor.replace(/(\d{3})(\d{3})(\d{1,3})/, '$1.$2.$3');
          } else if (valor.length > 3) {
            valor = valor.replace(/(\d{3})(\d{1,3})/, '$1.$2');
          }
          inputCpf.value = valor;
        });
      });

      // Validação simples de e-mail (só verifica se tem "@")
      document.addEventListener('DOMContentLoaded', () => {
        const inputEmail = document.getElementById('email');
        const erro = document.getElementById('erro-email');

        inputEmail.addEventListener('blur', () => {
          const valor = inputEmail.value.trim();

          if (valor && !valor.includes('@')) {
            erro.textContent = 'Formato de e-mail inválido.';
          } else {
            erro.textContent = '';
          }
        });
      });

      // Validação de senhas iguais
      document.addEventListener('DOMContentLoaded', () => {
        const senha = document.getElementById('senha');
        const confirma = document.getElementById('confirma');
        const erroSenha = document.getElementById('erro-senha');

        function validarSenhas() {
          if (confirma.value && senha.value !== confirma.value) {
            erroSenha.textContent = 'As senhas não coincidem.';
          } else {
            erroSenha.textContent = '';
          }
        }

        senha.addEventListener('input', validarSenhas);
        confirma.addEventListener('input', validarSenhas);
      });

      // Envio do formulário com validação
      document.addEventListener('DOMContentLoaded', () => {
        const btnCadastrar = document.querySelector('.entrar');

        btnCadastrar.addEventListener('click', () => {
          const nome = document.getElementById('nome').value.trim();
          const cpf = document.getElementById('cpf').value.trim();
          const email = document.getElementById('email').value.trim();
          const nascimento = document.getElementById('nascimento').value;
          const senha = document.getElementById('senha').value;
          const confirma = document.getElementById('confirma').value;
          const erroEmail = document.getElementById('erro-email');
          const erroSenha = document.getElementById('erro-senha');

          // Verifica campos obrigatórios
          if (!nome || !cpf || !email || !nascimento || !senha || !confirma) {
            alert('Preencha todos os campos.');
            return;
          }

          // Salva os dados no localStorage
          const usuario = {
            nome,
            cpf,
            email,
            nascimento,
            senha
          };

          localStorage.setItem('usuario', JSON.stringify(usuario));
          window.location.href = 'index.html';
        });
      });
    </script>
  </body>
</html>
